import Chrome from"./chrome.min.mjs";import Log from"./log.min.mjs";import Common from"./common.min.mjs";import Background from"./background.min.mjs";export default class Options{constructor(){const e=new Common;e.set_ui_language(),e.parse_messages(),e.parse_html(),e.check_dark_mode(),e.set_validator(),Chrome.get_storage(e.get_defaults(),this.set_options)}set_options(e){try{const o=Options.get_time(e.review_time),s=$("#single_notification"),t=$("#inbox_notification"),c=$("#alerts_notification"),n=$("#subscriptions_notification");e.show_user_info&&$("#section_user_info").prop("checked",!0),e.show_links&&$("#section_links").prop("checked",!0),e.show_inbox&&$("#section_inbox").prop("checked",!0),e.show_alerts&&$("#section_alerts").prop("checked",!0),e.show_subscriptions&&$("#section_subscriptions").prop("checked",!0),e.show_bookmarks&&$("#section_bookmarks").prop("checked",!0),e.single_notification&&(s.prop("checked",!0),t.prop("checked",!1),c.prop("checked",!1),n.prop("checked",!1)),e.inbox_notification&&(s.prop("checked",!1),t.prop("checked",!0)),e.alerts_notification&&(s.prop("checked",!1),c.prop("checked",!0)),e.subscriptions_notification&&(s.prop("checked",!1),n.prop("checked",!0)),$("#hours").val(o.hours),$("#minutes").val(o.minutes),$("#seconds").val(o.seconds),$("#milliseconds").val(o.milliseconds),s.on("change",(()=>{t.prop("checked",!1),c.prop("checked",!1),n.prop("checked",!1)})),t.on("change",(e=>{let o=e.currentTarget;$(o).is(":checked")&&s.prop("checked",!1)})),c.on("change",(e=>{let o=e.currentTarget;$(o).is(":checked")&&s.prop("checked",!1)})),n.on("change",(e=>{let o=e.currentTarget;$(o).is(":checked")&&s.prop("checked",!1)})),$(".loading-box").fadeOut((()=>{$(".options-page").fadeIn()})),$.validator&&$("#form_options").validate({submitHandler:Options.save_options})}catch(e){new Log("Options set_options").error(e)}}static save_options(){try{const e=parseInt($("#milliseconds").val())+1e3*parseInt($("#seconds").val())+60*parseInt($("#minutes").val())*1e3+60*parseInt($("#hours").val())*60*1e3,o={show_user_info:$("#section_user_info").is(":checked"),show_links:$("#section_links").is(":checked"),show_inbox:$("#section_inbox").is(":checked"),show_alerts:$("#section_alerts").is(":checked"),show_subscriptions:$("#section_subscriptions").is(":checked"),show_bookmarks:$("#section_bookmarks").is(":checked"),single_notification:$("#single_notification").is(":checked"),inbox_notification:$("#inbox_notification").is(":checked"),alerts_notification:$("#alerts_notification").is(":checked"),subscriptions_notification:$("#subscriptions_notification").is(":checked"),review_time:e>0?e:0},s=()=>{$(".alert-response").removeClass("bg-green-100 border-green-500 text-green-500 bg-red-100 border-red-500 text-red-500").addClass("hidden"),$(".alert-processing").removeClass("hidden").hide().slideDown((()=>{$(".alert-processing").addClass("hidden");try{(new Background).set_alarm(e,Common.check_data),$(".alert-response .alert-title").html(Chrome.get_message("label_saved_success")),$(".alert-response .alert-text").html(Chrome.get_message("message_saved_success")),$(".alert-response").addClass("bg-green-100 border-green-500 text-green-500").removeClass("hidden").hide().slideDown((()=>{setTimeout((()=>{$(".alert-response").fadeOut("slow")}),3e3)}))}catch(e){new Log("Options save_options - callback").error(e),$(".alert-response .alert-title").html(Chrome.get_message("label_saved_error")),$(".alert-response .alert-text").html(Chrome.get_message("message_saved_error")),$(".alert-response").addClass("bg-red-100 border-red-500 text-red-500").removeClass("hidden").hide().slideDown((()=>{setTimeout((()=>{$(".alert-response").fadeOut("slow")}),3e3)}))}}))};Chrome.set_storage(o,s)}catch(e){new Log("Options save_options").error(e)}}static get_time(e){e=parseInt(e);try{const o=Math.floor(e/1e3),s=Math.floor(o/60);return{milliseconds:e%1e3,seconds:o%60,minutes:s%60,hours:Math.floor(s/60)%60}}catch(e){new Log("Common get_time").error(e)}}}