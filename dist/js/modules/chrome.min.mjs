import Log from"./log.min.mjs";export default class Chrome{static get_message(e){return chrome.i18n.getMessage(e)}static get_ui_language(){return chrome.i18n.getUILanguage()}static get_storage(e,t=null){chrome.storage.sync.get(e,t)}static set_storage(e,t=null){chrome.storage.sync.set(e,t)}static create_alarm(e,t,r=null){try{chrome.alarms.clear(e),chrome.alarms.onAlarm.addListener((t=>{t.name===e&&null!==r&&r()})),chrome.alarms.get(e,(r=>{void 0===r&&chrome.alarms.create(e,t)}))}catch(e){new Log("Chrome create_alarm").error(e)}}static on_installed_listener(e){chrome.runtime.onInstalled.addListener(e)}static on_installed_reason(e){return"install"===e?chrome.runtime.OnInstalledReason.INSTALL:"update"===e?chrome.runtime.OnInstalledReason.UPDATE:null}static create_tab(e,t,r=null){null===r&&(r=e=>{}),1===e?chrome.tabs.create({url:Chrome.get_resource_url(t)},r):2===e&&chrome.tabs.create({url:t},r)}static highlight_tab(e,t){chrome.tabs.highlight({windowId:e,tabs:t})}static query_tab(e,t){chrome.tabs.query({url:e},t)}static get_resource_url(e){return chrome.runtime.getURL(e)}static set_badge(e){chrome.browserAction.setBadgeText({text:""}),e>0&&(chrome.browserAction.setBadgeBackgroundColor({color:[0,177,235,255]}),chrome.browserAction.setBadgeText({text:e.toString()}))}static get_badge(e){chrome.browserAction.getBadgeText({},e)}static send_notification(e,t,r){r?chrome.notifications.clear(e,(r=>{chrome.notifications.create(e,t)})):chrome.notifications.update(e,t)}static add_notification_listener(e){let t=t=>{if(void 0!==e[t]){let r=e[t].notification_url,o=e=>{let t=e.shift();0===e.length?Chrome.create_tab(2,r):Chrome.highlight_tab(t.windowId,t.index)};Chrome.query_tab(r,o)}};chrome.notifications.onClicked.removeListener(t),chrome.notifications.onClicked.addListener(t)}}